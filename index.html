<!doctype html>
<html lang="nl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Interactief financieel plan</title>

  <link rel="stylesheet" href="css/style.css" />
  <link rel="stylesheet"
        href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
        referrerpolicy="no-referrer" />
</head>

<body>
  <header class="wrap">
    <div class="topbar">
      <div>
        <h1><i class="fa-solid fa-chart-line"></i> <span data-i18n="title">Interactief financieel plan</span></h1>
        <p class="muted"><i class="fa-solid fa-bolt"></i> <span data-i18n="tagline">Alles lokaal, geen backend. Alles is auto & live.</span></p>
      </div>
      <div class="topbar-actions">
        <div class="lang-switch" role="group" aria-label="Language selector">
          <button type="button" class="lang-btn" data-lang-toggle="en" aria-pressed="true">EN</button>
          <button type="button" class="lang-btn" data-lang-toggle="nl" aria-pressed="false">NL</button>
        </div>
        <button class="btn" id="resetBtn" type="button" title="" data-i18n-title="resetBtnTitle">
          <i class="fa-solid fa-rotate-left"></i> <span data-i18n="resetBtn">Reset (Excel defaults)</span>
        </button>
        <button class="btn" id="copyLinkBtn" type="button" title="Copy shareable link" data-i18n-title="copyLinkBtnTitle">
          <i class="fa-solid fa-link"></i> <span data-i18n="copyLinkBtn">Copy link</span>
        </button>
        <button class="btn" id="exportCsvBtn" type="button" title="Export scenario as CSV" data-i18n-title="exportCsvBtnTitle">
          <i class="fa-solid fa-file-export"></i> <span data-i18n="exportCsvBtn">Export CSV</span>
        </button>
        <span id="copyStatus" class="muted" style="margin-left:8px; font-size:12px;"></span>
      </div>
    </div>
  </header>

  <main class="wrap grid">
    <!-- INPUTS -->
    <section class="card">
      <div class="cardTitle">
        <h2><i class="fa-solid fa-sliders"></i> <span data-i18n="inputsTitle">Inputs</span></h2>
        <span class="muted" data-i18n="inputsSubtitle">Wijzig â†’ live update</span>
      </div>

      <div class="group">
        <div class="groupTitle"><i class="fa-solid fa-gear"></i> <span data-i18n="group.general">Algemeen</span></div>
        <div class="controls">
          <div class="field">
            <label><i class="fa-regular fa-calendar"></i> <span data-i18n="label.horizonYears">Horizon (jaren)</span></label>
            <input type="number" min="1" max="60" step="1" data-path="horizonYears">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-wallet"></i> <span data-i18n="label.monthlyBudget">Maandbudget (lening + sparen) (â‚¬ / maand)</span></label>
            <input type="number" min="0" step="10" data-path="monthlyBudget">
          </div>
        </div>
        <div class="hint" data-i18n="hint.budgetDistribution">Dit budget wordt automatisch verdeeld: leningbetaling eerst, overschot gaat naar sparen.</div>
      </div>

      <div class="group">
        <div class="groupTitle"><i class="fa-solid fa-piggy-bank"></i> <span data-i18n="group.saving">Spaargeld</span></div>
        <div class="controls">
          <div class="field">
            <label><i class="fa-solid fa-wallet"></i> <span data-i18n="label.cashNow">Huidig spaargeld (â‚¬)</span></label>
            <input type="number" min="0" step="50" data-path="cash.now">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-shield-heart"></i> <span data-i18n="label.setAsidePct">% apart houden (0.15 = 15%)</span></label>
            <input type="number" min="0" max="1" step="0.01" data-path="cash.setAsidePct">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-percent"></i> <span data-i18n="label.savingRate">Rendement spaarrekening (% / jaar)</span></label>
            <input type="number" min="0" max="15" step="0.1" data-path="saving.annualRatePct">
          </div>
        </div>
      </div>

      <div class="group">
        <div class="groupTitle"><i class="fa-solid fa-building"></i> <span data-i18n="group.realEstate">Vastgoed</span></div>
        <div class="controls">
          <div class="field">
            <label><i class="fa-solid fa-tag"></i> <span data-i18n="label.realEstatePrice">Aankoopprijs appartement (â‚¬)</span></label>
            <input type="number" min="0" step="1000" data-path="realEstate.price">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-file-invoice-dollar"></i> <span data-i18n="label.purchaseCostPct">Aankoopkosten (% van prijs, 0.10 = 10%)</span></label>
            <input type="number" min="0" max="0.5" step="0.01" data-path="realEstatePurchaseCostPct">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-arrow-trend-up"></i> <span data-i18n="label.realEstateGrowthPct">Waardestijging vastgoed (% / jaar)</span></label>
            <input type="number" min="0" max="20" step="0.1" data-path="realEstate.annualGrowthPct">
          </div>
        </div>
      </div>

      <div class="group">
        <div class="groupTitle"><i class="fa-solid fa-file-invoice-dollar"></i> <span data-i18n="group.loan">Lening</span></div>
        <div class="controls">
          <div class="field">
            <label><i class="fa-solid fa-percent"></i> <span data-i18n="label.loanRate">Rente lening (% / jaar)</span></label>
            <input type="number" min="0" max="15" step="0.1" data-path="loan.annualRatePct">
          </div>
          <div class="field">
            <label><i class="fa-regular fa-clock"></i> <span data-i18n="label.loanYears">Looptijd lening (jaren)</span></label>
            <input type="number" min="1" max="40" step="1" data-path="loan.years">
          </div>
        </div>
      </div>

      <div class="group">
        <div class="groupTitle"><i class="fa-solid fa-key"></i> <span data-i18n="group.rent">Verhuur</span></div>
        <div class="controls">
          <div class="field">
            <label><i class="fa-solid fa-toggle-on"></i> <span data-i18n="label.rentEnabled">Verhuur inschakelen</span></label>
            <div class="row">
              <input type="checkbox" data-path="rent.enabled">
              <span class="muted" data-i18n="label.enabled">Enabled</span>
            </div>
          </div>
          <div class="field">
            <label><i class="fa-regular fa-calendar-plus"></i> <span data-i18n="label.rentStartAfterYears">Start verhuren na (jaren)</span></label>
            <input type="number" min="0" step="1" data-path="rent.startAfterYears">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-euro-sign"></i> <span data-i18n="label.rentMonthlyRent">Huurprijs (â‚¬ / maand)</span></label>
            <input type="number" min="0" step="10" data-path="rent.monthlyRent">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-house-circle-xmark"></i> <span data-i18n="label.rentVacancy">Leegstand (0.25 = 25%)</span></label>
            <input type="number" min="0" max="1" step="0.01" data-path="rent.vacancyRate">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-fire-extinguisher"></i> <span data-i18n="label.rentInsurance">Brandverzekering (0.10 = 10%)</span></label>
            <input type="number" min="0" max="1" step="0.01" data-path="rent.insuranceRate">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-receipt"></i> <span data-i18n="label.rentTax">Onroerende voorheffing (0.10 = 10%)</span></label>
            <input type="number" min="0" max="1" step="0.01" data-path="rent.taxRate">
          </div>
          <div class="field">
            <label><i class="fa-solid fa-screwdriver-wrench"></i> <span data-i18n="label.rentMaintenance">Onderhoud (0.20 = 20%)</span></label>
            <input type="number" min="0" max="1" step="0.01" data-path="rent.maintenanceRate">
          </div>
        </div>
      </div>
    </section>

    <!-- OUTPUTS -->
    <aside class="card">
      <div class="cardTitle">
        <h2><i class="fa-solid fa-gauge-high"></i> <span data-i18n="resultsTitle">Resultaten</span></h2>
        <span class="muted" id="subtitle"></span>
      </div>

      <div class="kpis">
        <!-- Startkapitaal -->
          <div class="kpi-section">
          <div class="kpi-section-title">ğŸ’° <span data-i18n="kpi.startCapital">Startkapitaal</span></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.setAside">Apart gezet</div><div class="kpiV" id="kpiSetAside"></div></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.investable">Investeerbaar (nu)</div><div class="kpiV" id="kpiInvestable"></div></div>
        </div>

        <!-- Vastgoedaankoop -->
          <div class="kpi-section">
          <div class="kpi-section-title">ğŸ  <span data-i18n="kpi.realEstatePurchase">Vastgoedaankoop</span></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.downPayment">Inbreng (auto)</div><div class="kpiV" id="kpiDownPayment"></div></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.principal">Leningbedrag (auto)</div><div class="kpiV" id="kpiPrincipal"></div></div>
          <div class="kpi">
            <div class="muted" data-i18n="kpi.purchaseCosts">Aankoopkosten</div>
            <div>
              <div class="kpiV" id="kpiPurchaseCosts"></div>
              <div class="kpiPct muted" id="kpiPurchaseCostsPct"></div>
            </div>
          </div>
          <div class="kpi"><div class="muted" data-i18n="kpi.totalPurchase">Totale aankoop</div><div class="kpiV" id="kpiTotalPurchase"></div></div>
        </div>

        <!-- Maandbudget & Lening -->
        <div class="kpi-section">
          <div class="kpi-section-title">ğŸ“Š <span data-i18n="kpi.budgetLoan">Maandbudget & Lening</span></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.monthlyBudget">Maandbudget</div><div class="kpiV" id="kpiMonthlyBudget"></div></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.loanMonthly">Lening afbetaling/maand</div><div class="kpiV" id="kpiLoanMonthly"></div></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.extraSaved">Overschot â†’ sparen/maand</div><div class="kpiV" id="kpiExtraSaved"></div></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.totalMonthlySaving">Totaal sparen/maand</div><div class="kpiV" id="kpiTotalMonthlySaving"></div></div>
        </div>

        <!-- Na horizon (25 jaar) -->
        <div class="kpi-section">
          <div class="kpi-section-title">ğŸ“ˆ <span data-i18n="kpi.afterHorizon">Na horizon</span></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.saving">Sparen</div><div class="kpiV" id="kpiSaving"></div></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.realEstateValue">Vastgoedwaarde</div><div class="kpiV" id="kpiRE"></div></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.loanBalance">Leningrest</div><div class="kpiV" id="kpiLoanBalance"></div></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.equity">Netto equity</div><div class="kpiV" id="kpiEquity"></div></div>
        </div>

        <!-- Verhuur -->
        <div class="kpi-section">
          <div class="kpi-section-title">ğŸ˜ï¸ <span data-i18n="kpi.rent">Verhuur (na horizon)</span></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.rentNetMonthly">Netto verhuur/maand</div><div class="kpiV" id="kpiRentNetMonthly"></div></div>
          <div class="kpi"><div class="muted" data-i18n="kpi.rentProfit">Verhuur winst (horizon)</div><div class="kpiV" id="kpiRentProfit"></div></div>
        </div>

        <!-- Totaal Vermogen -->
        <div class="kpi" style="grid-column:1 / -1; background:rgba(124,92,255,.12); border-color:rgba(124,92,255,.4);">
          <div class="muted"><strong data-i18n="kpi.totalWealthHeading">ğŸ’ TOTAAL VERMOGEN</strong></div>
          <div class="kpiV" id="kpiTotalWealth"></div>
          <div class="muted" style="font-size:11px; margin-top:4px;" data-i18n="kpi.totalBreakdown">Sparen + Equity + Huurwinst</div>
        </div>
      </div>

      <div class="chart" id="chart"></div>
    </aside>
  </main>

  <!-- COMPARISON SECTION -->
  <section class="wrap">
    <div class="card">
      <div class="cardTitle">
        <h2><i class="fa-solid fa-code-compare"></i> <span data-i18n="compare.title">Scenario's vergelijken</span></h2>
        <span class="muted" data-i18n="compare.subtitle">Vastgoed vs. Enkel sparen</span>
      </div>

      <div style="display:grid; grid-template-columns: 1fr 1fr; gap:16px; margin-bottom:20px;">
        <!-- Savings-only scenario -->
        <div>
          <div class="kpi" style="background:rgba(249,115,22,.1); border-color:rgba(249,115,22,.3);">
            <div class="muted"><strong>ğŸ“Š <span data-i18n="compare.scenario1Title">Scenario 1: Enkel sparen</span></strong></div>
            <div class="muted" style="font-size:11px; margin-bottom:8px; opacity:.7;" data-i18n="compare.scenario1Subtitle">Geen vastgoed, volledig budget â†’ spaarrekening</div>
            <div class="kpiV" id="savingsOnlyTotal"></div>
          </div>
        </div>

        <!-- Recommendation -->
        <div>
          <div class="kpi" style="background:rgba(124,92,255,.12); border-color:rgba(124,92,255,.4);">
            <div class="muted"><strong>ğŸ¯ <span data-i18n="compare.whichBetter">Welke is beter?</span></strong></div>
            <div id="scenarioComparison" style="font-size:12px; margin-top:8px; line-height:1.6; color:rgba(233,236,255,.85);"></div>
          </div>
        </div>
      </div>

      <!-- Charts -->
      <div style="margin-top:20px;">
        <div style="display:grid; grid-template-columns: 1fr 1fr; gap:16px;">
          <div>
            <h3 style="font-size:13px; margin:0 0 12px 0; color:rgba(233,236,255,.7);"><span data-i18n="chart.withRent">ğŸ“ˆ Met huurinkomsten</span></h3>
            <div class="compare-grid" id="chartWithRent"></div>
          </div>

          <div>
            <h3 style="font-size:13px; margin:0 0 12px 0; color:rgba(233,236,255,.7);"><span data-i18n="chart.withoutRent">ğŸ“Š Zonder huurinkomsten (puur belegging)</span></h3>
            <div class="compare-grid" id="chartWithoutRent"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- TIMELINE SECTION -->
  <section class="wrap">
    <div class="card">
      <div class="cardTitle">
        <h2><i class="fa-solid fa-chart-line"></i> <span data-i18n="timeline.title">Tijdslijn: Wanneer is vastgoed beter?</span></h2>
        <span class="muted" data-i18n="timeline.subtitle">Vermogen door de jaren heen</span>
      </div>

      <div style="display:flex; gap:12px; align-items:center; margin-bottom:12px;">
        <label style="display:flex; gap:8px; align-items:center; font-size:13px;">
          <input type="checkbox" id="showBreakEven" checked> <span data-i18n="timeline.showBreakEven">Toon breakeven-markers</span>
        </label>
        <button class="btn" id="toggleTimelineTable" data-i18n="timeline.toggleTable">Toon jaartabel</button>
        <button class="btn" id="downloadTimelineCsv" data-i18n="timeline.downloadCsv">Download timeline (CSV)</button>
      </div>

      <div style="margin-bottom:16px; position:relative;">
        <canvas id="timelineChart" width="800" height="350" style="max-width:100%; border-radius:12px;"></canvas>
        <div id="timelineTooltip" class="tooltip" style="display:none;"></div>
      </div> 

      <div id="timelineBreakdown" style="display:grid; grid-template-columns: 1fr 1fr; gap:12px; font-size:12px;">
      </div>

      <div id="timelineTableWrapper" style="display:none; margin-top:12px;">
        <div class="card" style="padding:10px;">
          <div style="overflow:auto; max-height:320px;">
            <table id="timelineTable" style="width:100%; border-collapse:collapse;">
              <thead>
                <tr style="text-align:left; color:var(--muted); font-size:12px;">
                  <th data-i18n="table.year">Jaar</th>
                  <th data-i18n="table.realEstateWithRent">Vastgoed (met huur)</th>
                  <th data-i18n="table.realEstateWithoutRent">Vastgoed (geen huur)</th>
                  <th data-i18n="table.savingsOnly">Enkel sparen</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </section>

  <!-- CASHFLOW & AMORTISATIE -->
  <section class="wrap">
    <div class="card">
      <div class="cardTitle">
        <h2><i class="fa-solid fa-wallet"></i> <span data-i18n="cashflow.title">Cashflow & Amortisatie</span></h2>
        <span class="muted" data-i18n="cashflow.subtitle">Jaarlijkse samenvatting</span>
      </div>

      <div style="display:grid; grid-template-columns: 1fr; gap:16px;">
        <div>
          <div style="display:flex; gap:8px; align-items:center; margin-bottom:10px;">
            <strong style="font-size:13px;" data-i18n="cashflow.titleShort">Jaarlijkse cashflow</strong>
            <button class="btn" id="exportCashflowCsv" data-i18n="cashflow.exportCsv">Export CSV</button>
          </div>
          <div style="overflow:auto; max-height:320px;">
            <table id="cashflowTable" style="width:100%; border-collapse:collapse;">
              <thead>
                <tr style="text-align:left; color:var(--muted); font-size:12px;">
                  <th data-i18n="table.year">Jaar</th>
                  <th data-i18n="cashflow.grossRent">Huur bruto</th>
                  <th data-i18n="cashflow.netRent">Netto huur</th>
                  <th data-i18n="cashflow.loanYear">Lening (jr)</th>
                  <th data-i18n="cashflow.netCash">Netto cashflow</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>

        </div>

        <div>
          <div style="display:flex; gap:8px; align-items:center; margin-bottom:10px;">
            <strong style="font-size:13px;" data-i18n="amort.title">Amortisatie (jaarlijks)</strong>
            <div style="display:flex; gap:8px; align-items:center; margin-left:8px;">
              <button class="btn" id="exportAmortCsv" data-i18n="amort.exportCsv">Export CSV</button>
              <button class="btn" id="toggleExpandAmort" aria-pressed="false" type="button" data-i18n="amort.expandAll">Uitklappen alles</button>
            </div>
          </div>
          <div style="overflow:auto; max-height:320px;">
            <table id="amortTable" style="width:100%; border-collapse:collapse;">
              <thead>
                <tr style="text-align:left; color:var(--muted); font-size:12px;">
                  <th data-i18n="table.year">Jaar</th>
                  <th data-i18n="amort.startBalance">Startsaldo</th>
                  <th data-i18n="amort.paid">Betaald (jr)</th>
                  <th data-i18n="amort.interest">Rente (jr)</th>
                  <th data-i18n="amort.principal">Kapitaal (jr)</th>
                  <th data-i18n="amort.endBalance">Eindsaldo</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
        </div>
      </div>

    </div>
  </section>

  <script type="module" src="js/main.js"></script>
</body>
</html>